diff --git a/src/lib/copy.ts b/src/lib/copy.ts
new file mode 100644
index 0000000000000000000000000000000000000000..a5bd6ccf2701a988fde89a2eb86b9620768263fe
--- /dev/null
+++ b/src/lib/copy.ts
@@ -0,0 +1,107 @@
+const ensureToastContainer = () => {
+  let container = document.querySelector<HTMLElement>("#copy-toast-container");
+  if (!container) {
+    container = document.createElement("div");
+    container.id = "copy-toast-container";
+    container.className = "pointer-events-none fixed top-5 right-5 z-50 flex flex-col gap-2";
+    document.body.appendChild(container);
+  }
+  return container;
+};
+
+const showToast = (message: string, variant: "success" | "error" = "success") => {
+  const container = ensureToastContainer();
+  const toast = document.createElement("div");
+  toast.textContent = message;
+  toast.className = `pointer-events-auto rounded-full px-4 py-2 text-sm font-semibold text-white shadow-lg shadow-black/20 transition duration-200 ${variant === "error" ? "bg-red-500" : "bg-emerald-500"}`;
+  container.appendChild(toast);
+
+  requestAnimationFrame(() => {
+    toast.classList.add("opacity-100");
+  });
+
+  setTimeout(() => {
+    toast.classList.add("opacity-0", "translate-y-1");
+  }, 1500);
+
+  setTimeout(() => {
+    toast.remove();
+  }, 2000);
+};
+
+const writeWithClipboardApi = async (text: string) => {
+  if (!navigator.clipboard || !navigator.clipboard.writeText) return false;
+  try {
+    await navigator.clipboard.writeText(text);
+    return true;
+  } catch (error) {
+    return false;
+  }
+};
+
+const legacyCopy = (text: string) => {
+  const textarea = document.createElement("textarea");
+  textarea.value = text;
+  textarea.setAttribute("readonly", "true");
+  textarea.style.position = "fixed";
+  textarea.style.top = "-9999px";
+  document.body.appendChild(textarea);
+  textarea.focus();
+  textarea.select();
+
+  let copied = false;
+  try {
+    copied = document.execCommand("copy");
+  } catch (error) {
+    copied = false;
+  }
+
+  document.body.removeChild(textarea);
+  return copied;
+};
+
+const manualPromptFallback = (text: string) => {
+  window.prompt("コピーできない場合は、以下のテキストを選択してコピーしてください", text);
+};
+
+const handleCopyClick = async (button: HTMLButtonElement) => {
+  const code = button.dataset.copyCode ?? "";
+  const label = button.querySelector<HTMLElement>(".copy-label");
+  const originalLabel = label?.textContent ?? "コピー";
+
+  if (label) label.textContent = "Copying...";
+  let resetTimer = 0;
+  const resetLabel = (duration: number) => {
+    window.clearTimeout(resetTimer);
+    resetTimer = window.setTimeout(() => {
+      if (label) label.textContent = originalLabel;
+    }, duration);
+  };
+
+  const copied = (await writeWithClipboardApi(code)) || legacyCopy(code);
+
+  if (copied) {
+    if (label) label.textContent = "Copied!";
+    button.classList.add("ring", "ring-emerald-300/40");
+    showToast("Copied!");
+    resetLabel(2000);
+    setTimeout(() => {
+      button.classList.remove("ring", "ring-emerald-300/40");
+    }, 2000);
+    return;
+  }
+
+  showToast("コピーできませんでした。長押しで選択・コピーしてください。", "error");
+  if (label) label.textContent = "コピーに失敗";
+  resetLabel(2500);
+  manualPromptFallback(code);
+};
+
+export const setupCopyButtons = () => {
+  const copyButtons = document.querySelectorAll<HTMLButtonElement>(".copy-btn");
+  copyButtons.forEach((button) => {
+    if (button.dataset.copyBound === "true") return;
+    button.dataset.copyBound = "true";
+    button.addEventListener("click", () => handleCopyClick(button));
+  });
+};
diff --git a/src/pages/index.astro b/src/pages/index.astro
index 6fa29f2c7b57e58b47f5563a1aa0cbfd8be7f654..c3fb77f1ed4480b956789da38c52afa49795cfd1 100644
--- a/src/pages/index.astro
+++ b/src/pages/index.astro
@@ -147,82 +147,66 @@ const latest = [...snippets].sort(
           <div class="flex items-center justify-between">
             <h3 class="text-lg font-semibold">{category}</h3>
             <span class="rounded-full bg-indigo-500/20 px-3 py-1 text-xs font-semibold text-indigo-50 ring-1 ring-indigo-300/40">{items.length} 件</span>
           </div>
           <ul class="mt-3 space-y-2 text-sm text-slate-200/85">
             {items.map((item) => (
               <li class="flex items-center justify-between gap-3 rounded-xl border border-white/10 bg-white/5 px-3 py-2">
                 <div>
                   <p class="font-semibold text-white">{item.title}</p>
                   <p class="text-xs text-slate-300/80">{item.description}</p>
                 </div>
                 <a
                   href={`/snippets/${item.slug}/`}
                   class="rounded-full border border-white/15 bg-white/10 px-3 py-1 text-[11px] font-semibold text-white transition hover:border-indigo-200/50 hover:bg-white/20"
                 >
                   詳細
                 </a>
               </li>
             ))}
           </ul>
         </article>
       ))}
     </div>
   </section>
 
-  <script>
+  <script type="module">
+    import { setupCopyButtons } from "../lib/copy";
+
     document.addEventListener("DOMContentLoaded", () => {
       const searchInput = document.querySelector<HTMLInputElement>("#search");
       const categorySelect = document.querySelector<HTMLSelectElement>("#category");
       const typeSelect = document.querySelector<HTMLSelectElement>("#type");
       const cards = Array.from(document.querySelectorAll<HTMLElement>("[data-snippet]"));
       const resultCount = document.querySelector<HTMLElement>("#result-count");
 
       const applyFilters = () => {
         const keyword = searchInput?.value.trim().toLowerCase() ?? "";
         const category = categorySelect?.value ?? "";
         const type = typeSelect?.value ?? "";
 
         let visible = 0;
         cards.forEach((card) => {
           const matchesKeyword = keyword
             ? ["title", "description", "tags", "code"].some((field) =>
                 card.dataset[field]?.includes(keyword),
               )
             : true;
           const matchesCategory = category ? card.dataset.category === category : true;
           const matchesType = type ? card.dataset.type === type : true;
           const show = matchesKeyword && matchesCategory && matchesType;
           card.style.display = show ? "flex" : "none";
           if (show) visible += 1;
         });
 
         if (resultCount) {
           resultCount.textContent = `${visible} 件ヒット`;
         }
       };
 
       [searchInput, categorySelect, typeSelect].forEach((el) => el?.addEventListener("input", applyFilters));
       applyFilters();
 
-      const copyButtons = document.querySelectorAll<HTMLButtonElement>(".copy-btn");
-      copyButtons.forEach((button) => {
-        button.addEventListener("click", async () => {
-          const code = button.dataset.copyCode ?? "";
-          const label = button.querySelector<HTMLElement>(".copy-label");
-          const original = label?.textContent ?? "コピー";
-          try {
-            await navigator.clipboard.writeText(code);
-            if (label) label.textContent = "コピーしました";
-            button.classList.add("ring", "ring-indigo-300/40");
-            setTimeout(() => {
-              if (label) label.textContent = original;
-              button.classList.remove("ring", "ring-indigo-300/40");
-            }, 1500);
-          } catch (error) {
-            if (label) label.textContent = "コピーに失敗";
-          }
-        });
-      });
+      setupCopyButtons();
     });
   </script>
 </BaseLayout>
diff --git a/src/pages/snippets/[slug].astro b/src/pages/snippets/[slug].astro
index 1c8c7d5781fbac3d97fc342d8f5e807d1e895a4a..2adf30671692cabf8138f027b7ee8cc61af8c368 100644
--- a/src/pages/snippets/[slug].astro
+++ b/src/pages/snippets/[slug].astro
@@ -57,49 +57,33 @@ const related = snippets
       </div>
     </div>
 
     {related.length > 0 && (
       <div class="grid gap-3 rounded-2xl border border-white/10 bg-white/5 p-5">
         <div class="flex items-center justify-between">
           <h2 class="text-lg font-semibold">同じカテゴリーのスニペット</h2>
           <span class="rounded-full bg-indigo-500/20 px-3 py-1 text-xs font-semibold text-indigo-50 ring-1 ring-indigo-300/40">{related.length} 件</span>
         </div>
         <div class="grid gap-3 sm:grid-cols-3">
           {related.map((item) => (
             <a
               class="rounded-2xl border border-white/10 bg-slate-950/60 p-4 transition hover:-translate-y-0.5 hover:border-indigo-300/40"
               href={`/snippets/${item.slug}/`}
             >
               <p class="text-xs uppercase tracking-[0.2em] text-indigo-200">{item.category}</p>
               <p class="mt-1 font-semibold text-white">{item.title}</p>
               <p class="text-xs text-slate-300/80">{item.description}</p>
             </a>
           ))}
         </div>
       </div>
     )}
   </section>
 
-  <script>
+  <script type="module">
+    import { setupCopyButtons } from "../../lib/copy";
+
     document.addEventListener("DOMContentLoaded", () => {
-      const copyButtons = document.querySelectorAll<HTMLButtonElement>(".copy-btn");
-      copyButtons.forEach((button) => {
-        button.addEventListener("click", async () => {
-          const code = button.dataset.copyCode ?? "";
-          const label = button.querySelector<HTMLElement>(".copy-label");
-          const original = label?.textContent ?? "コピー";
-          try {
-            await navigator.clipboard.writeText(code);
-            if (label) label.textContent = "コピーしました";
-            button.classList.add("ring", "ring-indigo-300/40");
-            setTimeout(() => {
-              if (label) label.textContent = original;
-              button.classList.remove("ring", "ring-indigo-300/40");
-            }, 1500);
-          } catch (error) {
-            if (label) label.textContent = "コピーに失敗";
-          }
-        });
-      });
+      setupCopyButtons();
     });
   </script>
 </BaseLayout>
