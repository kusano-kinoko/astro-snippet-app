---
import type { Snippet } from "../lib/csv";

const { snippet } = Astro.props as { snippet: Snippet };

const withBase = (path: string) => `${import.meta.env.BASE_URL}${path.replace(/^\//, "")}`;
---
<article
  class="flex flex-col gap-4 rounded-2xl border border-white/10 bg-white/5 p-5 shadow-lg shadow-indigo-500/10 transition hover:-translate-y-0.5 hover:border-indigo-300/30 hover:shadow-indigo-500/30"
  data-snippet
  data-title={snippet.title.toLowerCase()}
  data-description={snippet.description.toLowerCase()}
  data-tags={snippet.tags.join(" ").toLowerCase()}
  data-code={snippet.code.toLowerCase()}
  data-category={snippet.category}
  data-type={snippet.type}
>
  <header class="flex items-start justify-between gap-3">
    <div>
      <p class="text-xs uppercase tracking-[0.2em] text-indigo-200">{snippet.category}</p>
      <h3 class="mt-1 text-xl font-semibold text-white">{snippet.title}</h3>
      <p class="mt-1 text-sm text-slate-200/80">{snippet.description}</p>
    </div>
    <span class="rounded-full bg-indigo-500/20 px-3 py-1 text-[11px] font-semibold text-indigo-50 ring-1 ring-indigo-300/40">
      {snippet.type}
    </span>
  </header>
  <div class="grid gap-3 text-sm font-mono text-indigo-100">
    <div class="rounded-xl border border-white/10 bg-slate-950/60 p-4">
      <pre class="whitespace-pre-wrap">{snippet.code}</pre>
    </div>
    <div class="flex flex-wrap items-center justify-between gap-3">
      <div class="flex flex-wrap gap-2">
        {snippet.tags.map((tag) => (
          <span class="rounded-full bg-white/10 px-2 py-0.5 text-[11px] font-semibold text-indigo-50 ring-1 ring-white/10">{tag}</span>
        ))}
      </div>
      <div class="flex gap-2">
        <a
          class="rounded-full border border-white/15 bg-white/10 px-3 py-1.5 text-xs font-semibold text-white transition hover:border-indigo-200/50 hover:bg-white/20"
          href={withBase(`/snippets/${snippet.slug}/`)}
        >
          è©³ç´°ã‚’è¦‹ã‚‹
        </a>
        <button
          class="copy-btn inline-flex items-center gap-2 rounded-full bg-indigo-500 px-3 py-1.5 text-xs font-semibold text-white shadow-lg shadow-indigo-500/40 transition hover:-translate-y-0.5 hover:shadow-indigo-500/60"
          type="button"
          data-copy-code={snippet.code}
        >
          <span aria-hidden="true">ðŸ“‹</span>
          <span class="copy-label">ã‚³ãƒ”ãƒ¼</span>
        </button>
      </div>
    </div>
  </div>
</article>
